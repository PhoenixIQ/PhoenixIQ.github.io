"use strict";(self.webpackChunkphoenixiq_github_io=self.webpackChunkphoenixiq_github_io||[]).push([[47740],{82441:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>o,default:()=>k,frontMatter:()=>t,metadata:()=>c,toc:()=>l});var r=n(85893),i=n(11151);const t={id:"phoenix-kafka-extend",title:"Kafka \u6269\u5c55",description:"Phoenix \u5bf9 KafkaClient \u7684\u6269\u5c55\uff0c\u652f\u6301\u6d88\u606f\u5206\u5757"},o=void 0,c={id:"phoenix-advanced/phoenix-kafka-extend",title:"Kafka \u6269\u5c55",description:"Phoenix \u5bf9 KafkaClient \u7684\u6269\u5c55\uff0c\u652f\u6301\u6d88\u606f\u5206\u5757",source:"@site/versioned_docs/version-2.6.0/09-phoenix-advanced/04-kafka-extend.md",sourceDirName:"09-phoenix-advanced",slug:"/phoenix-advanced/phoenix-kafka-extend",permalink:"/docs/2.6.0/phoenix-advanced/phoenix-kafka-extend",draft:!1,unlisted:!1,editUrl:"https://github.com/PhoenixIQ/versioned_docs/version-2.6.0/09-phoenix-advanced/04-kafka-extend.md",tags:[],version:"2.6.0",sidebarPosition:4,frontMatter:{id:"phoenix-kafka-extend",title:"Kafka \u6269\u5c55",description:"Phoenix \u5bf9 KafkaClient \u7684\u6269\u5c55\uff0c\u652f\u6301\u6d88\u606f\u5206\u5757"},sidebar:"docs",previous:{title:"\u5206\u5e03\u5f0f\u6570\u636e",permalink:"/docs/2.6.0/phoenix-advanced/phoenix-distributed-data"},next:{title:"\u7ebf\u7a0b\u6c60\u9965\u997f\u68c0\u6d4b\u5668",permalink:"/docs/2.6.0/phoenix-advanced/starvation-detector"}},s={},l=[{value:"\u4e00. Kafka \u589e\u5f3a\u6269\u5c55",id:"kafka-extend",level:2},{value:"\u7b80\u4ecb",id:"kafka-extend-introduce",level:3},{value:"\u4f7f\u7528\u573a\u666f",id:"kafka-extend-scene",level:3},{value:"\u4f7f\u7528\u8bf4\u660e",id:"kafka-extend-usage",level:3},{value:"0. \u5f15\u5165 Kafka Extend \u4f9d\u8d56",id:"kafka-extend-dependency",level:4},{value:"1. Phoenix Client\u3001\u5185\u90e8\u8ba2\u9605\u7b49",id:"kafka-extend-client",level:4},{value:"2. \u81ea\u5b9a\u4e49\u8ba2\u9605",id:"kafka-extend-subscribe",level:4},{value:"3. Spring Kafka Producer \u96c6\u6210",id:"kafka-extend-producer",level:4},{value:"4. Spring Kafka Consumer \u96c6\u6210",id:"kafka-extend-consumer",level:4},{value:"\u5185\u90e8\u5904\u7406",id:"kafka-extend-internal",level:3},{value:"1. Offset",id:"kafka-extend-offset",level:4},{value:"2. Offset Tracking",id:"kafka-extend-tracking",level:4},{value:"3. Rebalanced",id:"kafka-extend-rebalanced",level:4},{value:"4. \u5185\u5b58\u5f00\u9500",id:"kafka-extend-memory-cost",level:4},{value:"5. \u6027\u80fd\u5f00\u9500",id:"kafka-extend-perf-cost",level:4},{value:"6. \u517c\u5bb9\u6027",id:"kafka-extend-compatible",level:4},{value:"7. \u6d88\u606f\u8def\u7531",id:"kafka-extend-router",level:4},{value:"\u4e8c. \u81ea\u5b9a\u4e49 Kafka \u5206\u533a\u9009\u62e9\u5668",id:"partition-selector",level:2},{value:"\u63a5\u53e3\u5b9e\u73b0",id:"partition-selector-api",level:3},{value:"\u914d\u7f6e\u5b9e\u73b0",id:"partition-selector-config",level:3},{value:"FAQ",id:"faq",level:2},{value:"1. KafkaProducer NoSuchMethodException",id:"no-such-method",level:3},{value:"2. Uncaught exception in thread &#39;kafka-producer-network-thread",id:"uncaught",level:3},{value:"3. \u5206\u533a\u9009\u62e9\u5668\u7684\u5206\u533a\u6570\u91cf\u95ee\u9898",id:"shard-num",level:3},{value:"4. OversizedPayloadException",id:"oversize",level:3},{value:"5. java.lang.AbstractMethodError",id:"method-error",level:3},{value:"6. LargeMessageSendException",id:"large-message-send",level:3},{value:"7. InvalidProtocolBufferException",id:"invalid",level:3},{value:"8. \u9002\u7528\u573a\u666f/\u4e0d\u9002\u7528\u573a\u666f",id:"scene",level:3}];function d(e){const a={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{children:"\u672c\u6587\u6863\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff08\u90fd\u662f\u5bf9 Phoenix-Kafka \u80fd\u529b\u505a\u7684\u4e00\u4e9b\u6269\u5c55\uff09\uff1a"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsx)(a.li,{children:"Kafka \u589e\u5f3a\u6269\u5c55\uff1a\u8ba9 Phoenix Kafka Client \u652f\u6301 LargeMessage \u7684\u6d88\u606f\u53d1\u9001"}),"\n",(0,r.jsx)(a.li,{children:"Kafka \u5206\u533a\u9009\u62e9\u5668\uff1a\u4e3a Phoenix \u5185\u90e8\u6a21\u5757\u6d88\u606f\u53d1\u9001\uff08Producer\uff09\u5b9a\u4e49\u53d1\u9001\u7684\u5206\u533a\u9009\u62e9\u7b56\u7565"}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"kafka-extend",children:"\u4e00. Kafka \u589e\u5f3a\u6269\u5c55"}),"\n",(0,r.jsxs)(a.blockquote,{children:["\n",(0,r.jsx)(a.p,{children:"\u8fd9\u91cc\u7684 Kafka \u589e\u5f3a\u6269\u5c55\u53ea\u662f Phoenix \u5bf9 KafkaClient \u7684\u9884\u7559\u4e86\u6269\u5c55\u63a5\u53e3, \u5185\u7f6e\u4e86 Linkedin \u7684 KafkaClient \u4f5c\u4e3a Apache KafkaClient\n\u7684\u589e\u5f3a\u6269\u5c55"}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"kafka-extend-introduce",children:"\u7b80\u4ecb"}),"\n",(0,r.jsxs)(a.p,{children:["Phoenix \u6846\u67b6\u4e3a\u4e86\u89e3\u51b3 Kafka \u6d88\u606f\u4f20\u8f93\u4e2d\u7684 LargeMessage \u95ee\u9898\uff0c\u63d0\u4f9b/\u9884\u7559\u4e86\u53ef\u914d\u7f6e KafkaClient \u589e\u5f3a\u6269\u5c55\uff0c\u5176\u4e2d\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u662f Chunk\nMessage\uff0c\u5728\u63a2\u7d22\u4e4b\u540e\u672c\u7740\u4e0d\u91cd\u590d\u9020\u8f6e\u5b50\u7684\u539f\u5219\uff0cPhoenix \u5185\u7f6e\u96c6\u6210\u4e86\u652f\u6301 LargeMessage \u7684\n",(0,r.jsx)(a.a,{href:"https://github.com/linkedin/li-apache-kafka-clients",children:"Linkedin Kafka Client"})]}),"\n",(0,r.jsxs)(a.blockquote,{children:["\n",(0,r.jsxs)(a.p,{children:["\u5f53\u7136\uff0c\u901a\u8fc7\u66f4\u6539\u914d\u7f6e\u540e\uff0cKafka \u4e5f\u652f\u6301\u8d85\u8fc7\u9ed8\u8ba4\u5927\u5c0f\u7684\u6d88\u606f\uff0cLinkedin\uff08\u539f Kafka \u5f00\u53d1\u8005\uff09\u505a\u4e86\u76f8\u5173\u7684 ",(0,r.jsx)(a.a,{href:"https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines",children:"Benchmark"}),"."]}),"\n",(0,r.jsx)(a.p,{children:"\u4f46\u662f\u4e0d\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\uff0cLarge messages \u53ef\u80fd\u4f1a\u5bf9 Broker \u548c JVM \u9020\u6210\u5f71\u54cd\uff0c\u7136\u540e\u62d6\u6162 JVM \u901f\u5ea6"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"\u5f53\u7136\uff0c\u9664\u4e86 Phoenix \u7684\u65b9\u6848\u5916\uff0cKafka Large Message \u4e5f\u6709\u5176\u4ed6\u89e3\u51b3\u65b9\u6848\uff0c\u672c\u6587\u6863\u4e0d\u5177\u4f53\u5c55\u5f00\uff1a"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Kafka \u548c\u5916\u90e8\u5b58\u50a8\u4e2d\u662f\u7528\u57fa\u4e8e\u5f15\u7528\u7684\u6d88\u606f\u4f20\u9012\uff08Reference-based\uff09"}),"\n",(0,r.jsx)(a.li,{children:"\u5728 KafkaClient \u4e2d\u4f7f\u7528\u65e0\u9700\u5916\u90e8\u5b58\u50a8\u7684\u5185\u7f6e Large Message \u652f\u6301\uff08Phoenix \u6240\u7528\uff09"}),"\n",(0,r.jsx)(a.li,{children:"\u5185\u7f6e Large Message \u652f\u6301 + \u5206\u5c42\u5b58\u50a8\uff08tiered storage\uff09"}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"kafka-extend-scene",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,r.jsx)(a.p,{children:"Kafka \u6269\u5c55\uff08\u4e3b\u8981\u662f Large Message \u7684\u652f\u6301\uff09\u9700\u8981\u53cc\u7aef\u4f7f\u7528\u7edf\u4e00\u5ba2\u6237\u7aef\uff08Consumer\u3001Producer\uff09\uff0c\u76ee\u524d\u8bc6\u522b\u5230\u7684\u573a\u666f\u6709\uff1a"}),"\n",(0,r.jsx)(a.admonition,{type:"info",children:(0,r.jsx)(a.p,{children:"\u5173\u4e8e CLIENT_CONSUMER \u7b49 Phoenix \u6a21\u5757\u914d\u7f6e\u5728 com.iquantex.phoenix.core.connect.kafka.PhoenixKafkaClientModule \u4e2d\u5b9a\u4e49"})}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["\u5f53\u805a\u5408\u6839\u53d1\u51fa/\u56de\u590d\u7684\u4e8b\u4ef6\u5927\u5c0f\u8d85\u51fa Kafka \u9650\u5236\u65f6\uff1a",(0,r.jsx)(a.code,{children:"CLIENT_CONSUMER <-> SERVER_PRODUCER"}),"  (\u7528\u4e8ePhoenixClient RPC\n\u6a21\u5f0f\u4e0b\u54cd\u5e94\u7684\u63a5\u6536)"]}),"\n",(0,r.jsxs)(a.li,{children:["\u5f53 EventPublish \u53d1\u51fa\u7684\u4e8b\u4ef6\u5927\u5c0f\u8d85\u51fa Kafka \u9650\u5236\u65f6\uff1a",(0,r.jsx)(a.code,{children:"EVENT_PUBLISH_PRODUCER <-> spring.consumer"})," \uff08\u7528 spring kafka \u5916\u90e8\u8ba2\u9605\uff09"]}),"\n",(0,r.jsxs)(a.li,{children:["\u5f53 PhoenixClient \u53d1\u51fa\u7684\u547d\u4ee4\u5927\u4e8e Kafka \u9650\u5236\u65f6\uff1a",(0,r.jsx)(a.code,{children:"CLIENT_PRODUCER <-> SERVER_CONSUMER"}),"\uff08\u7528\u4e8ePhoenixClient RPC\u3001\u5f02\u6b65\u6a21\u5f0f\uff09"]}),"\n",(0,r.jsxs)(a.li,{children:["\u5f53 KafkaTemplate\uff08spring kafka \u5ba2\u6237\u7aef\uff09\u53d1\u51fa\u7684\u547d\u4ee4\u5927\u4e8e Kafka \u9650\u5236\u65f6\uff1a",(0,r.jsx)(a.code,{children:"spring.producer <-> SERVER_CONSUMER"}),"\uff08\u5916\u90e8\u53d1\u9001\u7ed9\nPhoenix \u8ba2\u9605\u3001\u4e5f\u53ef\u4ee5\u662f\u7528\u6237\u7684\u81ea\u5b9a\u4e49\u8ba2\u9605\uff09"]}),"\n",(0,r.jsxs)(a.li,{children:["\u4e0d\u4f7f\u7528 Phoenix\uff0c\u4ec5\u4f7f\u7528 Kafka \u6269\u5c55\uff1a",(0,r.jsx)(a.code,{children:"spring.producer <-> spring.consumer"})]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"kafka-extend-usage",children:"\u4f7f\u7528\u8bf4\u660e"}),"\n",(0,r.jsxs)(a.p,{children:[":::caution \u6ce8\u610f\nPhoenix Kafka Extend \u76ee\u524d\u4ec5\u652f\u6301 K/V \u4e3a ",(0,r.jsx)(a.code,{children:"<String,byte[]>"})," \u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316. \u5982\u679c\u9700\u8981\u652f\u6301 ",(0,r.jsx)(a.code,{children:"<String,String>"}),"\uff0c\u8bf7\u4f20\u5165\u65f6\u4f7f\u7528 ",(0,r.jsx)(a.code,{children:"String.getBytes()"}),"\n\u6216\u63d0\u524d\u5c06 Value \u5e8f\u5217\u5316\n:::"]}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-dependency",children:"0. \u5f15\u5165 Kafka Extend \u4f9d\u8d56"}),"\n",(0,r.jsxs)(a.p,{children:["\u8bf7\u6ce8\u610f\uff0c",(0,r.jsx)(a.code,{children:"phoenix-kafka-extend"})," \u4f9d\u8d56 Phoenix \u6838\u5fc3 API \u5305 ",(0,r.jsx)(a.code,{children:"phoenix-core"})]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-xml",children:"<dependency>\n    <groupId>com.iquantex</groupId>\n    <artifactId>phoenix-kafka-extend-starter</artifactId>\n    <version>2.6.0</version>\n</dependency>\n"})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-client",children:"1. Phoenix Client\u3001\u5185\u90e8\u8ba2\u9605\u7b49"}),"\n",(0,r.jsxs)(a.p,{children:[":::tip \u63d0\u793a\n\u5f53\u60a8\u5728 Kubernetes \u73af\u5883\u4e2d\u901a\u8fc7\u73af\u5883\u53d8\u91cf\u914d\u7f6e ",(0,r.jsx)(a.code,{children:"spring-kafka-properties"})," \u65f6\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u8fd9\u79cd\u683c\u5f0f\uff1a"]}),"\n",(0,r.jsxs)(a.p,{children:[(0,r.jsx)(a.code,{children:"QUANTEX_PHOENIX_KAFKA_EXTEND_SPRING-KAFKA-PROPERTIES_BOOTSTRAP_SERVERS"})," \u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(a.code,{children:"QUANTEX_PHOENIX_KAFKA_EXTEND_SPRING_KAFKA_PROPERTIES_BOOTSTRAP_SERVERS"}),"\n:::"]}),"\n",(0,r.jsx)(a.p,{children:"\u9ed8\u8ba4\u5f00\u542f\u914d\u7f6e\u540e\uff0cPhoenix \u4f1a\u81ea\u52a8\u5c06 Apache Kafka Client \u66ff\u6362\u6210 Linkedin Kafka Clien"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-yaml",children:'quantex:\n  phoenix:\n    kafka:\n      extend:\n        # \u662f\u5426\u5f00\u542f Phoenix Kafka Extend\n        enabled: true\n        # \u662f\u5426\u8ba9 Server \u7aef\u5bf9 Client \u7684\u56de\u590d\u4f7f\u7528 Kafka \u589e\u5f3a Client \uff08RPC \u573a\u666f\uff0c\u9700\u8981\u540c\u65f6\u5f00\u542f client-consumer\uff09\n        server-producer-enabled: true\n        # \u662f\u5426\u8ba9 Client \u7aef\u63a5\u6536 Server \u7684\u54cd\u5e94\u4f7f\u7528 Kafka \u589e\u5f3a Client\uff08RPC \u573a\u666f\uff0c\u9700\u8981\u540c\u65f6\u5f00\u542f server-producer\uff09\n        client-consumer-enabled: true\n        # \u662f\u5426\u8ba9 Client \u7aef\u53d1\u9001\u7ed9 Server \u7684\u547d\u4ee4\u4f7f\u7528 Kafka \u589e\u5f3a Client\uff08\u9ed8\u8ba4\u6d88\u606f\u5165\u53e3\u573a\u666f\uff0c\u9700\u8981\u540c\u65f6\u5f00\u542f server-consumer\uff09\n        client-producer-enabled: true\n        # \u662f\u5426\u8ba9 Server \u7aef\u63a5\u6536 MQ \u8ba2\u9605\u4f7f\u7528 Kafka \u589e\u5f3a Client\uff08\u9ed8\u8ba4\u8ba2\u9605\u573a\u666f\uff0c\u9700\u8981\u540c\u65f6\u5f00\u542f client-producer \u6216\u63a5\u6536\u7684\u5916\u90e8 Client \u652f\u6301\uff09\n        server-consumer-enabled: true\n        # \u662f\u5426\u8ba9 EventPublish \u7aef\u53d1\u9001\u7ed9\u5916\u90e8\u7684\u6d88\u606f\u4f7f\u7528 Kafka \u589e\u5f3a Client\uff08\u9700\u8981\u5916\u90e8\u7684 KafkaConsumer \u652f\u6301\u589e\u5f3a Client\uff0c\u53ef\u4ee5\u7528 Phoenix-Spring \u7684\u96c6\u6210\uff09\n        event-publish-producer-enabled: true\n        # \u662f\u5426\u5f00\u542f Spring Consumer \u7684 Kafka \u589e\u5f3a Client\uff0cPhoenix \u4f1a\u6ce8\u518c\u4e00\u4e2a ConsumerFactory Bean\n        spring-consumer-enabled: true\n        # \u662f\u5426\u5f00\u542f Spring Producer \u7684 Kafka \u589e\u5f3a Client\uff0cPhoenix \u4f1a\u6ce8\u518c\u4e00\u4e2a ProducerFactory Bean\n        spring-producer-enabled: true\n        # Spring \u7684 Kafka \u589e\u5f3a Client \u7684\u914d\u7f6e\n        spring-kafka-properties:\n          "bootstrap.servers": 127.0.0.1:9092,127.0.0.1:9092,127.0.0.1:9092\n        # Linkedin Kafka \u914d\u7f6e\n        # Producer: \u666e\u901a\u6d88\u606f\u7684\u6700\u5927\u5927\u5c0f\uff0c\u8d85\u51fa\u5219\u5f00\u59cb\u5207\u5206. \u9ed8\u8ba4 50kb\n        max-message-bytes: 51200\n        # Consumer: \u7528\u4e8e\u7f13\u51b2\u4e0d\u5b8c\u6574\u5927\u6d88\u606f\u6bb5\u7684\u5185\u5b58\u603b\u5927\u5c0f\u4e0a\u9650\uff08\u9ed8\u8ba4\u662f 30mb\uff09\n        message-buffer-capacity: 32000000\n        # Consumer: LargeMessage \u8d77\u59cb Offset \u548c\u5f53\u524d Offset \u6700\u5927\u5dee\u8ddd\u503c\uff0c\u8d85\u51fa\u5219\u8ba4\u4e3a Large Message \u5df2\u4e0d\u5b8c\u6574\u3002\u9ed8\u8ba4 1000\n        message-expiration-offset-gap: 1000\n        # Consumer: \u6bcf\u4e2a\u5206\u533a\u8981\u8ddf\u8e2a Offset \u7684\u6700\u5927\u6d88\u606f\u6570\uff0c\u9ed8\u8ba4 500 \n        max-offset-track-pre-partition: 500\n'})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-subscribe",children:"2. \u81ea\u5b9a\u4e49\u8ba2\u9605"}),"\n",(0,r.jsxs)(a.p,{children:[":::info \u6ce8\u610f\u4e8b\u9879\n\u5f53 KafkaExtend \u7528\u4e8e\u6269\u5c55\u65f6\uff0c\u4ece Kafka \u63a5\u6536\u7684\u6d88\u606f\u4f53\u79ef\u53ef\u80fd\u4f1a\u5927\u4e8e 256KB\uff0c\u6b64\u65f6\u4f1a\u8d85\u51fa Phoenix \u5185\u90e8 akka \u7684\u9650\u5236\uff0c\u5982\u679c\u9700\u8981\u8ba9\u5927\u4e8e 256KB \u7684\u6d88\u606f\u53d1\u80fd\u591f\n\u53d1\u9001\u5230\u805a\u5408\u6839\uff0c\u5219\u9700\u8981\u66f4\u6539\u914d\u7f6e\uff0c\u5982\u66f4\u6539\u4e3a 4MB \u7684\u76f8\u5173\u914d\u7f6e\u4e3a\uff1a\uff08\u4f7f\u7528 ",(0,r.jsx)(a.code,{children:"quantex.phoenix.akka.akka-conf"})," \u81ea\u5b9a\u4e49 akka \u914d\u7f6e\uff09"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-CONF",children:"akka.remote.artery.advanced.maximum-frame-size= 4096 KiB\n"})}),"\n",(0,r.jsx)(a.p,{children:":::"}),"\n",(0,r.jsxs)(a.p,{children:["\u5f53\u5f00\u542f Kafka Extend \u540e\uff0cPhoenix \u4f1a\u5411 Spring \u6ce8\u518c\u4e00\u4e2a ",(0,r.jsx)(a.code,{children:"com.iquantex.phoenix.core.connect.kafka.KafkaClientProvider"})," \u7684 SpringBean."]}),"\n",(0,r.jsx)(a.p,{children:"\u7528\u6237\u53ef\u4ee5\u62ff\u5230\u8be5 Bean \u5e76\u6ce8\u518c\u5230 KafkaSubscribe \u4e2d\uff1a"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@Bean\npublic Subscribe customSubscribe(KafkaClientProvider clientProvider) {\n    Properties properties = new Properties();\n    properties.putIfAbsent(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "latest");\n    return new KafkaSubscribe(\n            mqAddress,\n            subscribeTopic,\n            appName,\n            properties,\n            new SelfDeseriSchema(),\n            clientProvider.getConsumer(PhoenixKafkaClientModule.SERVER_CONSUMER)); // \u662f\u7528\u548c SERVER_CONSUMER \u4e00\u6837\u7684\u914d\u7f6e\n        \n// \u5047\u8bbe\u7528\u6237\u4e0d\u5e0c\u671b Server \u8ba2\u9605\u4f7f\u7528 Kafka Extend\uff0c\u4ec5\u5bf9\u81ea\u5df1\u7684\u67d0\u4e2a\u81ea\u5b9a\u4e49\u8ba2\u9605\u9700\u8981\uff0c\u5219\u53ef\u4ee5\u662f\u7528\u9ed8\u8ba4\u7684\u589e\u5f3a Consumer\nConsumerFactory factory = clientProvider.getConsumer(PhoenixKafkaClientModule.ENHANCE_PRODUCER);        \n}\n'})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-producer",children:"3. Spring Kafka Producer \u96c6\u6210"}),"\n",(0,r.jsx)(a.p,{children:"\u5f53\u7528\u6237\u60f3\u8981\u5728 Phoenix \u5916\u90e8\uff08\u5176\u4ed6\u670d\u52a1\uff09\u4f7f\u7528 Phoenix Kafka Extend \u65f6\uff0c\u901a\u8fc7\u5f00\u5173\uff0cPhoenix \u4f1a\u5411 Spring \u6ce8\u518c KafkaClient Factory \u7684 SpringBean\uff0c\u7528\u6237\u53ea\u9700\u8981\u4fee\u6539 Spring Kafka Client \u7684\u914d\u7f6e\u5373\u53ef\u3002"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'/**\n * \u5728\u6ce8\u518c KafkaTemplate Bean \u65f6\uff0c\u4ece Spring IOC \u4e2d\u53d6\u51fa\u540d\u4e3a\uff1aphoenix-kafka-producer-extend \u7684 Spring \u63a5\u53e3 ProducerFactory \u7684\u5b9e\u73b0\u5b9e\u4f8b. \u7136\u540e\u4f5c\u4e3a KafkaTemplate \u7684\u53c2\u6570\u4f20\u5165 KafkaTemplate\n */\n@Bean\npublic KafkaTemplate<String, byte[]> kafkaTemplate(\n        @Qualifier(value = "phoenix-kafka-producer-extend")\n                ProducerFactory<String, byte[]> producerFactory) {\n    return new KafkaTemplate<String, byte[]>(producerFactory);\n}\n'})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-consumer",children:"4. Spring Kafka Consumer \u96c6\u6210"}),"\n",(0,r.jsx)(a.p,{children:"\u5f53\u7528\u6237\u60f3\u8981\u5728 Phoenix \u5916\u90e8\uff08\u5176\u4ed6\u670d\u52a1\uff09\u4f7f\u7528 Phoenix Kafka Extend \u65f6\uff0c\u901a\u8fc7\u5f00\u5173\uff0cPhoenix \u4f1a\u5411 Spring \u6ce8\u518c KafkaClient Factory \u7684 SpringBean\uff0c\u7528\u6237\u53ea\u9700\u8981\u4fee\u6539 Spring Kafka Client \u7684\u914d\u7f6e\u5373\u53ef\u3002"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'/**\n * \u540c\u7406\uff0c\u53ea\u9700\u8981\u66f4\u6539 ConcurrentKafkaListenerContainerFactory \u7684 ConsumerFactory \u5373\u53ef.\n * Phoenix \u4f1a\u6ce8\u5165\u540d\u4e3a phoenix-kafka-consumer-extend \u7684 Spring \u63a5\u53e3 ConsumerFactory \u7684\u5b9e\u73b0\u5b9e\u4f8b\n */\n@Bean\npublic ConcurrentKafkaListenerContainerFactory<String, byte[]> kafkaListenerContainerFactory(\n        @Qualifier(value = "phoenix-kafka-consumer-extend")\n                ConsumerFactory<String, byte[]> consumerFactory) {\n    ConcurrentKafkaListenerContainerFactory<String, byte[]> factory =\n            new ConcurrentKafkaListenerContainerFactory<>();\n    factory.setConsumerFactory(consumerFactory);\n    factory.setBatchListener(true);\n    factory.getContainerProperties().setAckMode(ContainerProperties.AckMode.MANUAL_IMMEDIATE);\n    return factory;\n}\n'})}),"\n",(0,r.jsx)(a.h3,{id:"kafka-extend-internal",children:"\u5185\u90e8\u5904\u7406"}),"\n",(0,r.jsxs)(a.p,{children:["\u672c\u6587\u6863\u53ea\u505a\u7b80\u5355\u4ecb\u7ecd\uff0c\u8be6\u7ec6\u8bf7\u53c2\u8003\uff1a",(0,r.jsx)(a.a,{href:"https://github.com/linkedin/li-apache-kafka-clients",children:"https://github.com/linkedin/li-apache-kafka-clients"})]}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-offset",children:"1. Offset"}),"\n",(0,r.jsx)(a.p,{children:"Kafka Extend \u5728\u5904\u7406 Large Message \u65f6\uff0c\u4f1a\u4ee5\u6700\u540e\u4e00\u4e2a Segment \u7684 Offset \u4f5c\u4e3a\u6d88\u606f\u7684 Offset"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"message",src:n(49109).Z+"",width:"828",height:"363"})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-tracking",children:"2. Offset Tracking"}),"\n",(0,r.jsx)(a.p,{children:"Kafka Extend \u4f1a\u5728 Records \u7684 Header \u4e2d\u6dfb\u52a0 Large Message \u7684\u4fe1\u606f\uff0c\u5e76\u5728 Client \u5185\u90e8\u7ef4\u62a4\uff0c\u5f53 Msg1 \u7684\u6d88\u606f\u4f20\u8f93\u53d1\u751f\u95ee\u9898\u65f6\uff0c\u7528\u6237\u53ef\u4ee5\u4ece Msg1 \u7684\u7b2c\u4e00\u4e2a Segment \u5f00\u59cb\u6d88\u8d39\uff08seek\uff09"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"message",src:n(19521).Z+"",width:"1000",height:"495"})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-rebalanced",children:"3. Rebalanced"}),"\n",(0,r.jsx)(a.p,{children:"\u5f53 Msg1 \u672a\u88ab\u4ea4\u4ed8\u7ed9 User \u65f6\uff0c\u6b64\u65f6\u91cd\u5e73\u8861\u540e\u4ece offset=0 \u5f00\u59cb\u6d88\u8d39"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"kafka-extend-before-rebalanced.png",src:n(48217).Z+"",width:"934",height:"403"})}),"\n",(0,r.jsx)(a.p,{children:"\u5f53 Msg1 \u6210\u529f\u4ea4\u4ed8\u7ed9 User \u4e4b\u540e\uff0cCommit \u4e2d\u9644\u52a0 Header \u5e26\u4e0a delivered=2 \u7684\u4fe1\u606f\uff0c\u5e76\u5728\u91cd\u5e73\u8861\u540e\u4ece offset=3 \u5f00\u59cb\u6d88\u8d39\u5e76\u4ea4\u4ed8\u7ed9 User"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"kafka-extend-after-rebalanced.png",src:n(51961).Z+"",width:"904",height:"323"})}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-memory-cost",children:"4. \u5185\u5b58\u5f00\u9500"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"\u751f\u4ea7\u8005\uff1a\u9664\u4e86\u6d88\u606f\u5207\u5206\uff08splitter\uff09\u548c\u6d88\u606f\u62f7\u8d1d\u5916\uff0c\u6ca1\u6709\u989d\u5916\u7684\u5185\u5b58\u5f00\u9500"}),"\n",(0,r.jsxs)(a.li,{children:["\u6d88\u8d39\u8005","\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"buffer.capacity"}),"\uff1a\u6d88\u8d39\u8005\u4f1a\u7f13\u5b58\u56fa\u5b9a\u957f\u5ea6\u7684\u6d88\u606f"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"expiration.offset.gap"}),"\uff1a\u5f53 Offset \u548c Large Message \u7684\u8d77\u59cb Offset \u8d85\u51fa\u4e00\u4e2a\u5dee\u503c\uff0c\u5219\u8ba4\u4e3a\u8be5\u6d88\u606f\u4e0d\u5b8c\u5168\uff0cKafkaExtend \u4f1a\u4e22\u5f03\u8be5\u6d88\u606f"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-perf-cost",children:"5. \u6027\u80fd\u5f00\u9500"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"\u989d\u5916\u7684\u6d88\u606f\u5207\u5206\uff08split\uff09\u548c\u7ec4\u88c5\uff08assemble\uff09 Segment \u7684\u5e8f\u5217\u5316\u5f00\u9500"}),"\n",(0,r.jsx)(a.li,{children:"Consumer \u4e2d MessageBuffer \u7684\u5f00\u9500"}),"\n",(0,r.jsx)(a.li,{children:"Consumer \u4e2d Offset Tracking \u7684\u5f00\u9500\uff08\u6bcf\u4e2a\u6d88\u606f\u5360\u7528 24 bytes\uff09"}),"\n"]}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-compatible",children:"6. \u517c\u5bb9\u6027"}),"\n",(0,r.jsx)(a.p,{children:"Linkedin Kafka \u76f8\u5173\u7684 Client \u5305\u6709\uff1a"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"com.linkedin.kafka.clients:li-apache-kafka-clients"}),"\uff1aPhoenix \u4f7f\u7528\uff0c\u7528\u4e8e LargeMessage \u652f\u6301"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.code,{children:"com.linkedin.kafka:kafka-clients"}),"\uff1ali-apache-kafka-clients \u7684\u4f9d\u8d56\uff0cPhoenix \u9ed8\u8ba4\u6392\u9664\uff0c\u53ef\u4f7f\u7528 Apache Kafka Client"]}),"\n"]}),"\n",(0,r.jsxs)(a.p,{children:["\u867d\u7136 Linked \u7684 ",(0,r.jsx)(a.code,{children:"li-apache-kafka-clients"}),"\u5bf9",(0,r.jsx)(a.code,{children:"com.linkedin.kafka:kafka-clients"}),"\u7684\u4f9d\u8d56\u53ef\u4f7f\u7528 Apache Kafka Client \u4ee3\u66ff\uff0c\u4f46\u4ecd\u7136\u6709\u4e00\u4e9b\u65b9\u6cd5\u662f Linkedin Kafka Client \u72ec\u6709\u7684\u3002\n\u56e0\u6b64\uff0c\u5047\u8bbe\u7528\u6237\u9700\u8981\u66f4\u597d\u7684 ",(0,r.jsx)(a.code,{children:"li-apache-kafka-clients"})," \u652f\u6301\uff0c\u8bf7\u4f7f\u7528 Linkedin \u81ea\u5df1\u7684 KafkaClient\uff08\u548c Apache Kafka Client \u51b2\u7a81\uff0c\u7c7b\u540d\u51e0\u4e4e\u4e00\u81f4\uff09 \u8bf7\u6839\u636e\u81ea\u8eab\u9700\u8981\u9009\u62e9\u3002"]}),"\n",(0,r.jsxs)(a.p,{children:["\u5728 Kafka Extend \u4e2d\u4f7f\u7528 Apache Kafka Client \u53ef\u80fd\u4f1a\u9047\u5230\u4e00\u4e9b\u517c\u5bb9\u95ee\u9898\uff0c\u4f8b\u5982 Producer flush() \u65b9\u6cd5\u7684 ",(0,r.jsx)(a.code,{children:"NoSuchMethodException"}),".(\u4e0d\u652f\u6301 Timeout\uff0c\u4e0d\u5f71\u54cd\u4e3b\u6d41\u7a0b\uff0c\u4f1a\u8d70\u5165\u65c1\u8def)"]}),"\n",(0,r.jsx)(a.h4,{id:"kafka-extend-router",children:"7. \u6d88\u606f\u8def\u7531"}),"\n",(0,r.jsx)(a.p,{children:"\u6b64\u5904\u7684\u6d88\u606f\u8def\u7531\u662f\u6307 Kafka \u8d85\u5927\u6d88\u606f\u7ecf\u8fc7 KafkaExtend \u5904\u7406\u4e4b\u540e\u7684\u540e\u7eed\u8def\u5f84\uff0c\u901a\u5e38\u6765\u8bf4\u5728\u4ec5\u4f7f\u7528 KafkaExtend \u7684 Producer \u4e0b\u65f6\u6ca1\u6709\u4efb\u4f55\u95ee\u9898\u7684\uff08\u56e0\u4e3a\u5df2\u7ecf\u662f\u5728 Phoenix \u4e2d\n\u6d88\u606f\u6d41\u8f6c\u7684\u6700\u540e\u4e00\u6b65\u3002\u5f53 KafkaExtend \u7528\u4e8e\u8ba2\u9605\u65f6\uff0c\u53ef\u80fd\u4f1a\u8ba9\u6d88\u606f\u8d85\u51fa Phoenix \u5185\u90e8\u6d88\u606f\u6d41\u8f6c\u7684\u5927\u5c0f\u9650\u5236\uff08256KB\uff09\u3002\u4e0b\u9762\u5206\u522b\u662f\u5f71\u54cd\u7684\u8def\u5f84\u548c\u4e0d\u5f71\u54cd\u7684\u8def\u5f84\uff1a"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"EventPublish KafkaProducer\uff1a\u4e0d\u53d7\u5f71\u54cd\uff0c\u6d88\u606f\u4e0d\u4f1a\u5728\u96c6\u7fa4\u5185\u4f20\u9012"}),"\n",(0,r.jsx)(a.li,{children:"DistributionData Broadcast\uff1b\u4e0d\u53d7\u5f71\u54cd\uff0c\u6d88\u606f\u4e0d\u4f1a\u5728\u96c6\u7fa4\u5185\u4f20\u9012"}),"\n",(0,r.jsx)(a.li,{children:"PhoenixServer Producer\uff1a\uff08\u901a\u5e38\u7528\u4e8e\u56de\u590d PhoenixClient \u5b9e\u73b0 RPC\uff09\u4e0d\u53d7\u5f71\u54cd\uff0c\u5728\u8fd9\u91cc\u6d88\u606f\u4f1a\u8de8 Actor\uff0c\u4f46\u4e0d\u4f1a\u8de8 JVM\uff0c\u8de8\u96c6\u7fa4\u8282\u70b9"}),"\n",(0,r.jsx)(a.li,{children:"Spring KafkaProducer\uff1a\u6b64\u9636\u6bb5\u4e0d\u53d7\u5f71\u54cd\uff0c\u53d6\u51b3\u4e8e Producer \u53d1\u5f80\u7684 Topic \u662f\u5426\u662f\u7531 Phoenix \u6d88\u8d39"}),"\n",(0,r.jsx)(a.li,{children:"Spring KafkaConsumer\uff1a\u4e0d\u53d7\u5f71\u54cd\uff0c\u8fd9\u91cc\u662f\u76f4\u63a5\u7531\u7528\u6237\u4ee3\u7801\u5904\u7406\u6d88\u606f\uff0c\u4e0d\u7ecf\u8fc7 Phoenix \u96c6\u7fa4\u53ca Actor \u5904\u7406"}),"\n",(0,r.jsx)(a.li,{children:"PhoenixClient\uff1a\u6b64\u9636\u6bb5\u4e0d\u53d7\u5f71\u54cd\uff0c\u4f46\u540e\u7eed\u53d1\u5f80\u7684 PhoenixServer \u5904\u7406\u53ef\u80fd\u4f1a\u53d7\u5f71\u54cd"}),"\n",(0,r.jsx)(a.li,{children:"PhoenixServer Subscribe\uff1a\u53d7\u5f71\u54cd\uff0c\u4e3b\u8981\u662f\u53d1\u5f80\u805a\u5408\u6839\u7684 Command \u5927\u5c0f\u4f1a\u88ab Phoenix \u5185\u90e8\u7684 Actor \u901a\u4fe1\u5927\u5c0f\u6240\u9650\u5236\uff08\u53ef\u914d\u7f6e\u66f4\u9ad8\uff09"}),"\n"]}),"\n",(0,r.jsxs)(a.p,{children:["\u5bf9\u4e8e Phoenix \u96c6\u7fa4\u5185\u90e8\u7684\u5927\u4f53\u79ef\u201c\u547d\u4ee4\u201d\u7684\u6d88\u606f\u4f20\u8f93\uff0c\u76ee\u524d\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e Akka \u914d\u7f6e\uff1a",(0,r.jsx)(a.code,{children:"akka.remote.artery.advanced.maximum-frame-size"})," \u77ed\u6682\u652f\u6301\u3002\n\u4f46\u66f4\u5927\u4f53\u79ef\u7684\u6d88\u606f\u4f20\u8f93\u610f\u5473\u7740\u66f4\u9ad8\u7684\u4e22\u5931\u6982\u7387\uff0c\u5373\u4f7f\u5728\u53ef\u9760\u4ea4\u4ed8\u7684\u4fdd\u8bc1\u4e0b\uff0c\u4e5f\u4f1a\u8ba9\u6d88\u606f\u7684\u5ef6\u8fdf\u589e\u52a0\uff1b\u5e76\u4e14\u8fd9\u4e2a\u914d\u7f6e\u5b58\u5728\u4e0a\u9650\uff0c\u5bf9\u4e8e\u8d85\u5927\u4f53\u79ef\uff08\u5927\u4e8e 10MB\uff09\uff0c\u5219\u4e0d\u5efa\u8bae\u7528\u8fd9\u79cd\u65b9\u5f0f\u3002"]}),"\n",(0,r.jsx)(a.p,{children:"\u540e\u7eed Phoenix \u4f1a\u652f\u6301\u5185\u90e8\u5927\u4f53\u79ef\u6d88\u606f\u7684 Chunk Message\uff08\u5206\u5757\u4f20\u8f93\uff09\uff0c\u8fd9\u80fd\u8ba9 Phoenix \u5185\u90e8\u652f\u6301\u4e0a\u8d85\u5927\u4f53\u79ef\u7684\uff08\u5927\u4e8e 10MB\uff09\u6d88\u606f\u4f20\u8f93"}),"\n",(0,r.jsx)(a.h2,{id:"partition-selector",children:"\u4e8c. \u81ea\u5b9a\u4e49 Kafka \u5206\u533a\u9009\u62e9\u5668"}),"\n",(0,r.jsx)(a.p,{children:"Phoenix \u652f\u6301\u5bf9 KafkaProducer \u53d1\u9001\u7684\u6d88\u606f\u5b9e\u73b0\u5206\u533a\u9009\u62e9\u7b56\u7565, \u652f\u6301\u914d\u7f6e\u7684\u6a21\u5757\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"phoenix-client\uff1a\u6d88\u606f\u53d1\u9001\u5230 Server \u8ba2\u9605\u7684\u4e3b Topic \u65f6\uff0c\u5206\u533a\u7684\u9009\u62e9\u7b56\u7565"}),"\n",(0,r.jsx)(a.li,{children:"phoenix-server: \u6d88\u606f\u54cd\u5e94/\u56de\u590d\u5230 PhoenixClient/\u5176\u4ed6\u56de\u590d\u8def\u5f84\u7684 Topic \u65f6\uff0c\u5206\u533a\u7684\u9009\u62e9\u7b56\u7565"}),"\n",(0,r.jsx)(a.li,{children:"phoenix-event-publish\uff1a\u4e8b\u4ef6\u6295\u9012\u901a\u8fc7 EventPublish \u6295\u9012\u65f6\uff0c\u5206\u533a\u7684\u9009\u62e9\u7b56\u7565"}),"\n",(0,r.jsx)(a.li,{children:"phoenix-distribution-data\uff1a\u5206\u5e03\u5f0f\u6570\u636e\u53d1\u5e03\u66f4\u65b0\u4e8b\u4ef6\u65f6\uff0c\u5206\u533a\u7684\u9009\u62e9\u7b56\u7565"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:":::tip \u63d0\u793a\n\u9664\u4e86\u4f5c\u4e3a\u5206\u533a\u9009\u62e9\u5668\u4e4b\u5916\uff0c\u8be5\u63a5\u53e3\u5b9e\u73b0\u4e5f\u53ef\u4ee5\u7528\u4e8e\u76d1\u63a7\u7528\u9014. \u4f8b\u5982\u5728\u5185\u90e8\u91c7\u96c6\u6d41\u91cf\u540e, \u8fd4\u56de -1 \u7684\u5206\u533a\u53f7\uff0c\u6b64\u65f6 Phoenix \u4e0d\u4f1a\u9009\u5b9a\u6295\u9012\u7684\u5206\u533a\uff0c\u800c\u662f\u8ba9 Kafka \u6839\u636e Key \u81ea\u884c\u51b3\u5b9a\u3002\n:::"}),"\n",(0,r.jsx)(a.h3,{id:"partition-selector-api",children:"\u63a5\u53e3\u5b9e\u73b0"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:"public interface PartitionSelector {\n\n    /** \u9009\u62e9 Kafka \u9ed8\u8ba4\u7684\u5206\u533a\u7b56\u7565. */\n    int KAFKA_DEFAULT = -1;\n\n    /**\n     * \u901a\u8fc7\u6d88\u606f\u7684key\u9009\u62e9\u4e00\u4e2a\u76ee\u6807\u5206\u533a\n     *\n     * @param key {@link org.apache.kafka.clients.producer.ProducerRecord} Key\n     * @param topic Topic\n     * @param partitionInfos Topic Partitions\n     * @return\n     */\n    int select(String key, String topic, List<PartitionInfo> partitionInfos);\n}\n"})}),"\n",(0,r.jsx)(a.h3,{id:"partition-selector-config",children:"\u914d\u7f6e\u5b9e\u73b0"}),"\n",(0,r.jsx)(a.p,{children:'\u4e0b\u9762\u6240\u793a\u7684\u914d\u7f6e\u5e76\u975e\u9ed8\u8ba4\u503c\uff0c\u800c\u662f\u5f53\u7528\u6237\u4e0d\u81ea\u5b9a\u4e49\u65f6\u9009\u62e9\u7684"\u9ed8\u8ba4\u5206\u533a\u9009\u62e9\u5668"\uff0cSpring \u914d\u7f6e\u7684\u9ed8\u8ba4\u503c\u4e3a null'}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-yaml",children:"quantex:\n  phoenix:\n    client:\n      mq:\n        # \u81ea\u5b9a\u4e49\u5206\u533a\u9009\u62e9\u5668\u5b9e\u73b0\uff08\u53d1\u9001\u5230 Phoenix MQ \u8ba2\u9605\uff09\n        partition-selector-class-name: com.iquantex.phoenix.core.connect.kafka.OriginPartitionSelector\n    server:\n      mq:\n        # \u81ea\u5b9a\u4e49\u5206\u533a\u9009\u62e9\u5668\u5b9e\u73b0\uff08\u56de\u590d\u7ed9 Client Topic\uff09\n        partition-selector-class-name: com.iquantex.phoenix.core.connect.kafka.OriginPartitionSelector\n    event-publish:\n      event-task:\n        # \u81ea\u5b9a\u4e49\u5206\u533a\u9009\u62e9\u5668\u5b9e\u73b0\uff08EventPublish \u5230\u6307\u5b9a Topic\uff09\n        partition-selector-class-name: com.iquantex.phoenix.eventpublish.mq.kafka.DefaultKafkaPartitionSelector\n      d-data-task:\n        # \u81ea\u5b9a\u4e49\u5206\u533a\u9009\u62e9\u5668\u5b9e\u73b0\uff08DData \u53d1\u9001\u5230 Phoenix MQ \u8ba2\u9605\uff09\n        partition-selector-class-name: com.iquantex.phoenix.eventpublish.mq.kafka.DefaultKafkaPartitionSelector\n"})}),"\n",(0,r.jsx)(a.h2,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(a.h3,{id:"no-such-method",children:"1. KafkaProducer NoSuchMethodException"}),"\n",(0,r.jsx)(a.p,{children:"\u6b63\u5e38\u73b0\u8c61\uff0c\u4e0d\u5f71\u54cd\u4e3b\u6d41\u7a0b\uff0c\u53c2\u8003\u517c\u5bb9\u6027\u95ee\u9898"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"[ WARN] [ispatcher-27] [c.producer.LiKafkaProducerImpl]: Wrapped KafkaProducer does not support time-bounded flush. MDC: {}\njava.lang.NoSuchMethodException: org.apache.kafka.clients.producer.KafkaProducer.flush(long, java.util.concurrent.TimeUnit)\n\tat java.lang.Class.getMethod(Class.java:1786)\n\tat com.linkedin.kafka.clients.producer.LiKafkaProducerImpl.<init>(LiKafkaProducerImpl.java:188)\n\tat com.linkedin.kafka.clients.producer.LiKafkaProducerImpl.<init>(LiKafkaProducerImpl.java:154)\n\tat com.iquantex.phoenix.client.mq.impl.kafka.LinkedKafkaProducerFactory.createProducer(LinkedKafkaProducerFactory.java:26)\n\tat com.iquantex.phoenix.core.connect.kafka.KafkaServerProducer.init(KafkaServerProducer.java:85)\n\tat com.iquantex.phoenix.server.akka.SenderActor.preStart(SenderActor.java:39)\n\tat akka.actor.Actor.aroundPreStart(Actor.scala:548)\n\tat akka.actor.Actor.aroundPreStart$(Actor.scala:548)\n\tat akka.actor.AbstractActor.aroundPreStart(AbstractActor.scala:220)\n\tat akka.actor.ActorCell.create(ActorCell.scala:643)\n\tat akka.actor.ActorCell.invokeAll$1(ActorCell.scala:513)\n\tat akka.actor.ActorCell.systemInvoke(ActorCell.scala:535)\n\tat akka.dispatch.Mailbox.processAllSystemMessages(Mailbox.scala:295)\n\tat akka.dispatch.Mailbox.run(Mailbox.scala:230)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\n\tat java.lang.Thread.run(Thread.java:750)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"uncaught",children:"2. Uncaught exception in thread 'kafka-producer-network-thread"}),"\n",(0,r.jsx)(a.p,{children:"\u8fd9\u662f\u56e0\u4e3a Linkedin Kafka Client \u4e0d\u652f\u6301\u90e8\u5206\u65b9\u6cd5\uff0c\u548c Spring \u7684\u517c\u5bb9\u6709\u70b9\u95ee\u9898\uff0c\u89e3\u51b3\u65b9\u6848\u662f\u4e0d\u5728 Spring KafkaTemplate \u4e2d\u662f\u7528 KafkaExtend"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"[2023-06-01 14:53:25,197] [ERROR] [| producer-9] [kafka.common.utils.KafkaThread]: Uncaught exception in thread 'kafka-producer-network-thread | producer-9': MDC: {}\njava.lang.AbstractMethodError: Method com/linkedin/kafka/clients/producer/LiKafkaProducerImpl.close(Ljava/time/Duration;)V is abstract\n\tat com.linkedin.kafka.clients.producer.LiKafkaProducerImpl.close(LiKafkaProducerImpl.java)\n\tat org.springframework.kafka.core.KafkaTemplate.closeProducer(KafkaTemplate.java:382)\n\tat org.springframework.kafka.core.KafkaTemplate.lambda$buildCallback$4(KafkaTemplate.java:433)\n\tat com.linkedin.kafka.clients.producer.LiKafkaProducerImpl$ErrorLoggingCallback.onCompletion(LiKafkaProducerImpl.java:525)\n\tat com.linkedin.kafka.clients.largemessage.LargeMessageCallback.onCompletion(LargeMessageCallback.java:49)\n\tat org.apache.kafka.clients.producer.KafkaProducer$InterceptorCallback.onCompletion(KafkaProducer.java:1348)\n\tat org.apache.kafka.clients.producer.internals.ProducerBatch.completeFutureAndFireCallbacks(ProducerBatch.java:227)\n\tat org.apache.kafka.clients.producer.internals.ProducerBatch.done(ProducerBatch.java:196)\n\tat org.apache.kafka.clients.producer.internals.Sender.completeBatch(Sender.java:707)\n\tat org.apache.kafka.clients.producer.internals.Sender.completeBatch(Sender.java:688)\n\tat org.apache.kafka.clients.producer.internals.Sender.handleProduceResponse(Sender.java:596)\n\tat org.apache.kafka.clients.producer.internals.Sender.access$100(Sender.java:74)\n\tat org.apache.kafka.clients.producer.internals.Sender$1.onComplete(Sender.java:798)\n\tat org.apache.kafka.clients.ClientResponse.onComplete(ClientResponse.java:109)\n\tat org.apache.kafka.clients.NetworkClient.completeResponses(NetworkClient.java:569)\n\tat org.apache.kafka.clients.NetworkClient.poll(NetworkClient.java:561)\n\tat org.apache.kafka.clients.producer.internals.Sender.runOnce(Sender.java:335)\n\tat org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:244)\n\tat java.lang.Thread.run(Thread.java:750)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"shard-num",children:"3. \u5206\u533a\u9009\u62e9\u5668\u7684\u5206\u533a\u6570\u91cf\u95ee\u9898"}),"\n",(0,r.jsxs)(a.p,{children:["\u5206\u533a\u9009\u62e9\u5668\u7684\u5206\u533a\u6570\u91cf\u4ec5\u4f1a\u5728\u7b2c\u4e00\u6b21\u83b7\u53d6\u65f6\u901a\u8fc7 KafkaClient ",(0,r.jsx)(a.code,{children:"partitionsFor(String topic)"})," \u83b7\u53d6\uff0c\u7136\u540e\u6b64\u7ed3\u679c\u88ab\u7f13\u5b58\u7528\u4e8e\u52a0\u901f\u3002"]}),"\n",(0,r.jsx)(a.p,{children:"\u5f53 Topic \u7684\u5206\u533a\u6570\u91cf\u6539\u53d8\u65f6\uff0cPhoenix \u4ecd\u4ee5\u672c\u5730\u5185\u5b58\u7f13\u5b58\u4e3a\u51c6\uff0c\u800c\u4e0d\u4f1a\u4e3b\u52a8\u66f4\u65b0\u5206\u533a\u6570\u91cf\uff08\u8fd9\u4e00\u70b9\u4e5f\u4f53\u73b0\u5728 Phoenix \u7684 MQ \u8ba2\u9605\u4e0a\uff09"}),"\n",(0,r.jsx)(a.h3,{id:"oversize",children:"4. OversizedPayloadException"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"akka.remote.OversizedPayloadException: Discarding oversized payload sent to ... : max allowed size 262144 bytes, actual size of encoded ... was ... bytes.\n"})}),"\n",(0,r.jsxs)(a.p,{children:["\u8fd9\u662f\u56e0\u4e3a\u53d1\u9001\u7684\u6d88\u606f\u5927\u5c0f\u8d85\u51fa\u4e86 Phoenix \u9ed8\u8ba4\u6d88\u606f\u7684 256KB \u5927\u5c0f\u7684\u9650\u5236\uff0c\u5982\u9700\u8981\u66f4\u6539\u4e3a 4MB \u7684\u76f8\u5173\u914d\u7f6e\u4e3a\uff1a\uff08\u4f7f\u7528 ",(0,r.jsx)(a.code,{children:"quantex.phoenix.akka.akka-conf"})," \u81ea\u5b9a\u4e49 akka \u914d\u7f6e\uff09"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-CONF",children:"akka.remote.artery.advanced.maximum-frame-size = 4096 KiB\n"})}),"\n",(0,r.jsx)(a.h3,{id:"method-error",children:"5. java.lang.AbstractMethodError"}),"\n",(0,r.jsxs)(a.p,{children:["\u5728 spring-kafka \u7248\u672c\u662f 2.5.x \u53ca\u4ee5\u4e0a\u65f6\uff08\u4f8b\u5982 spring-boot 2.3.7.RELEASE\uff09\u4f7f\u7528 ",(0,r.jsx)(a.code,{children:"phoenix-kafka-extend"})," \u4f1a\u5bfc\u81f4\u8be5\u9519\u8bef\uff0c\u5b8c\u6574\u9519\u8bef\u4fe1\u606f\u5982\u4e0b\uff1a"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"java.lang.AbstractMethodError: com.linkedin.kafka.clients.consumer.LiKafkaConsumerImpl.committed(Ljava/util/Set;)Ljava/util/Map;\n"})}),"\n",(0,r.jsxs)(a.p,{children:["\u8fd9\u662f\u56e0\u4e3a 2.5.x \u7248\u672c\u7684 Spring kafka \u7684 KafkaMessageListenerContainer \u4f7f\u7528\u4e86\u4e00\u4e2a  ",(0,r.jsx)(a.code,{children:"phoenix-kafka-extend"})," \u4e2d Linkined Kafka Client \u672a\u5b9e\u73b0\u7684 KafkaConsumer \u6279\u91cf\u63d0\u4ea4\u65b9\u6cd5."]}),"\n",(0,r.jsxs)(a.p,{children:["\u5728 KafkaMessageListenerContainer \u6e90\u7801\u4e2d\uff0c\u8be5\u65b9\u6cd5\u6709\u4e2a\u524d\u7f6e\u6761\u4ef6\uff1a",(0,r.jsx)(a.code,{children:"commitCurrentOnAssignment"}),"\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8be5\u6761\u4ef6\u8df3\u8fc7\u8be5\u65b9\u6cd5\uff0c\u4ece\u800c\u89e3\u51b3 Linkined Kafka Client \u672a\u5b9e\u73b0 ",(0,r.jsx)(a.code,{children:"commited(Set<TopicPartitions> topicPartitions)"})," \u7684\u95ee\u9898"]}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"source",src:n(68752).Z+"",width:"1353",height:"471"})}),"\n",(0,r.jsx)(a.p,{children:"\u901a\u8fc7\u8be5\u524d\u7f6e\u6761\u4ef6\u7684\u8d4b\u503c\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 ContainerProperties.AssignmentCommitOption \u6765\u7b80\u5355\u89e3\u51b3\u6b64\u95ee\u9898"}),"\n",(0,r.jsx)(a.p,{children:(0,r.jsx)(a.img,{alt:"source",src:n(39501).Z+"",width:"1743",height:"663"})}),"\n",(0,r.jsxs)(a.p,{children:["\u89e3\u51b3\u65b9\u6848\u5982\u4e0b\uff0c\u540c\u7406\uff0c\u5728 commitCurrentOnAssignment \u7684\u8d4b\u503c\u65b9\u6cd5 ",(0,r.jsx)(a.code,{children:"determineCommitCurrent()"})," \u901a\u8fc7\u8d70\u5411\u5176\u4ed6\u5206\u652f\uff08\u6700\u7ec8\u5fc5\u987b\u662f false\uff09\u6765\u5b9e\u73b0\u8df3\u8fc7\u4e5f\u80fd\u7b80\u5355\u4fee\u590d\u6b64\u95ee\u9898\u3002"]}),"\n",(0,r.jsx)(a.p,{children:"\u9664\u6b64\u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u964d\u7ea7\u7b49\u65b9\u5f0f\u89e3\u51b3\u6b64\u95ee\u9898\u3002"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-java",children:'@Bean\npublic ConcurrentKafkaListenerContainerFactory<String, byte[]> kafkaListenerContainerFactory(\n@Qualifier(value = "phoenix-kafka-consumer-extend")\n                ConsumerFactory<String, byte[]> consumerFactory) {\n        ConcurrentKafkaListenerContainerFactory<String, byte[]> factory =\n        new ConcurrentKafkaListenerContainerFactory<>();\n        factory.setConsumerFactory(consumerFactory);\n        factory.setBatchListener(true);\n        factory.getContainerProperties().setAckMode(ContainerProperties.AckMode.MANUAL_IMMEDIATE);\n        // \u907f\u514d Spring Kafka \u4f7f\u7528\u6279\u91cf Commited\n        factory.getContainerProperties().setAssignmentCommitOption(ContainerProperties.AssignmentCommitOption.NEVER);\n        return factory;\n}\n'})}),"\n",(0,r.jsx)(a.h3,{id:"large-message-send",children:"6. LargeMessageSendException"}),"\n",(0,r.jsxs)(a.p,{children:["\u8fd9\u79cd\u60c5\u51b5\u662f\u914d\u7f6e\u7684 ",(0,r.jsx)(a.code,{children:"quantex.phoenix.kafka.extend.max-message-bytes"})," \u4e0e Kafka Server \u7684\u6700\u5927\u6d88\u606f\u5927\u5c0f\u4e0d\u5339\u914d\uff0cKafka Extend \u8981\u6c42\u6b64\u914d\u7f6e\u4f4e\u4e8e Kafka Server \u7684\u914d\u7f6e\u5927\u5c0f\uff0c\u8fd9\u662f\u56e0\u4e3a Kafka Extend \u4f1a\u5728\u62c6\u5206\u7684\u6d88\u606f\u4e2d\u9644\u52a0\u4e00\u4e9b\u5143\u6570\u636e\uff08\u6d88\u606f\u5206\u4e86\u591a\u5c11\u6279\u6765\u53d1\u9001\uff0c\u6d88\u606f\u603b\u957f\u5ea6\uff0c\u6d88\u606f\u5e8f\u53f7\u7b49\uff09"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"\n[0000-00-00 00:00:00] [ERROR] [| producer-3] [c.producer.LiKafkaProducerImpl]: Unable to send event [No Custom Info] with message id e7cfbd58b48445a2b28df03c03ba7226 to kafka topic xxxx-xxxx-xxx MDC: {}\ncom.linkedin.kafka.clients.largemessage.errors.LargeMessageSendException: Error when sending large message. Sent 1 of 11 segments.\n\tat com.linkedin.kafka.clients.largemessage.LargeMessageCallback.onCompletion(LargeMessageCallback.java:53)\n\tat org.apache.kafka.clients.producer.KafkaProducer$InterceptorCallback.onCompletion(KafkaProducer.java:1348)\n\tat org.apache.kafka.clients.producer.internals.ProducerBatch.completeFutureAndFireCallbacks(ProducerBatch.java:227)\n\tat org.apache.kafka.clients.producer.internals.ProducerBatch.done(ProducerBatch.java:196)\n\tat org.apache.kafka.clients.producer.internals.Sender.completeBatch(Sender.java:707)\n\tat org.apache.kafka.clients.producer.internals.Sender.completeBatch(Sender.java:688)\n\tat org.apache.kafka.clients.producer.internals.Sender.handleProduceResponse(Sender.java:596)\n\tat org.apache.kafka.clients.producer.internals.Sender.access$100(Sender.java:74)\n\tat org.apache.kafka.clients.producer.internals.Sender$1.onComplete(Sender.java:798)\n\tat org.apache.kafka.clients.ClientResponse.onComplete(ClientResponse.java:109)\n\tat org.apache.kafka.clients.NetworkClient.completeResponses(NetworkClient.java:569)\n\tat org.apache.kafka.clients.NetworkClient.poll(NetworkClient.java:561)\n\tat org.apache.kafka.clients.producer.internals.Sender.runOnce(Sender.java:335)\n\tat org.apache.kafka.clients.producer.internals.Sender.run(Sender.java:244)\n\tat java.lang.Thread.run(Thread.java:750)\nCaused by: org.apache.kafka.common.errors.RecordTooLargeException: The request included a message larger than the max message size the server will accept.\n"})}),"\n",(0,r.jsx)(a.h3,{id:"invalid",children:"7. InvalidProtocolBufferException"}),"\n",(0,r.jsxs)(a.p,{children:["\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e3b\u8981\u662f\u53d1\u9001\u7aef\u4f7f\u7528\u4e86 Kafka Extend\uff0c\u5e76\u53d1\u9001\u4e86\u8d85\u51fa ",(0,r.jsx)(a.code,{children:"quantex.phoenix.kafka.extend.max-message-bytes"})," \u5927\u5c0f\u7684\u4e8b\u4ef6\uff0c\u4f46\u63a5\u6536\u7aef\u672a\u6b63\u786e\u914d\u7f6e\u6210 Kafka Extend \u7684\u6d88\u8d39\u8005\u3002"]}),"\n",(0,r.jsxs)(a.p,{children:["\u5982\u679c\u662f Spring Kafka Listener\uff0c\u5219\u9700\u8981\u4fee\u6539 ",(0,r.jsx)(a.code,{children:"org.springframework.kafka.config.ConcurrentKafkaListenerContainerFactory"})," \u4e2d\u7684 ConsumerFactory \u4e3a Kafka Extend \u7684 Spring Bean."]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-log",children:"Caused by: com.google.protobuf.InvalidProtocolBufferException: Protocol message contained an invalid tag (zero).\n\tat com.google.protobuf.InvalidProtocolBufferException.invalidTag(InvalidProtocolBufferException.java:105)\n\tat com.google.protobuf.CodedInputStream$ArrayDecoder.readTag(CodedInputStream.java:609)\n\tat com.iquantex.phoenix.core.message.protobuf.Phoenix$Message.<init>(Phoenix.java:637)\n\tat com.iquantex.phoenix.core.message.protobuf.Phoenix$Message.<init>(Phoenix.java:593)\n\tat com.iquantex.phoenix.core.message.protobuf.Phoenix$Message$1.parsePartialFrom(Phoenix.java:4687)\n\tat com.iquantex.phoenix.core.message.protobuf.Phoenix$Message$1.parsePartialFrom(Phoenix.java:4681)\n\tat com.google.protobuf.AbstractParser.parsePartialFrom(AbstractParser.java:163)\n\tat com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:197)\n\tat com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:209)\n\tat com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:214)\n\tat com.google.protobuf.AbstractParser.parseFrom(AbstractParser.java:49)\n\tat com.iquantex.phoenix.core.message.protobuf.Phoenix$Message.parseFrom(Phoenix.java:2213)\n\tat com.iquantex.phoenix.core.message.Message.<init>(Message.java:40)\n\tat com.iquantex.phoenix.eventpublish.deserializer.DefaultMessageDeserializer.deserialize(DefaultMessageDeserializer.java:21)\n\t... 24 common frames omitted\n"})}),"\n",(0,r.jsx)(a.h3,{id:"scene",children:"8. \u9002\u7528\u573a\u666f/\u4e0d\u9002\u7528\u573a\u666f"}),"\n",(0,r.jsxs)(a.p,{children:["Kafka Extend \u9002\u7528\u4e8e\u90e8\u5206\uff0c\u4f4e\u9891\u7684\u6d88\u606f\u4e2d\u5b58\u5728\u8f83\u5927\u7684\u4f53\u79ef\u7684\u573a\u666f\uff0c\u4f7f\u7528 Kafka Extend \u65f6\u5e76\u4e0d\u4f1a\u603b\u662f\u5c06\u6d88\u606f\u62c6\u5206\u6210\u5206\u5757\uff0c\u666e\u901a\u4e8b\u4ef6\uff08\u5927\u5c0f\u4f4e\u4e8e",(0,r.jsx)(a.code,{children:"quantex.phoenix.kafka.extend.max-message-bytes"}),"\uff09\u603b\u662f\u4f1a\u6309\u7167\u539f\u6765\u7684\u65b9\u5f0f\u4f20\u9012\u3002"]}),"\n",(0,r.jsx)(a.p,{children:"Kafka Extend \u4e0d\u9002\u7528\u4e8e\u9891\u7e41\u3001\u591a\u6570\u7684\u6d88\u606f\u90fd\u662f\u8f83\u5927\u4f53\u79ef\u7684\u573a\u666f\uff0c\u5982\u6bcf\u79d2 1000 \u7b14 10mb \u5927\u5c0f\u7684\u6d88\u606f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u51e0\u4e4e\u8981\u6c42 Kafka Broker \u652f\u6301 10gb/s \u7684\u78c1\u76d8\u5199\u5165\u901f\u5ea6\uff0c\u7279\u522b\u662f\u805a\u5408\u6839\u9891\u7e41\u4f7f\u7528\u5927\u4f53\u79ef\u4e8b\u4ef6\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u538b\u529b\u8fc7\u5927\uff0c\u6700\u540e\u5bfc\u81f4\u6d88\u606f\u79ef\u538b\uff0c\n\u53c8\u4f1a\u5bfc\u81f4\u5185\u5b58\u538b\u529b\u8fc7\u5927\u3002"}),"\n",(0,r.jsx)(a.p,{children:"\u5982\uff0c\u9ed8\u8ba4\u914d\u7f6e\u4e0b EventPublish \u662f\u8bfb\u53d6 128 \u884c\u6570\u636e\u4e3a\u4e00\u4e2a\u6279\u6b21\uff0c\u5185\u5b58\u4e0a\u6700\u591a\u5b58\u50a8 64 \u4e2a\u6279\u6b21\uff0c\u6b64\u65f6\u5185\u5b58\u4e0a\u6700\u591a\u80fd\u62e5\u6709 8192 ~= 8GB\uff08\u5047\u8bbe\u4e00\u884c\u7684\u6570\u636e/\u4e8b\u4ef6\u5927\u5c0f\u662f 1MB\uff09\uff0c\u8fd9\u4f1a\u5bfc\u81f4 JVM \u53d1\u751f OOM\u3002"}),"\n",(0,r.jsx)(a.p,{children:"\u56e0\u6b64 Kafka Extend \u652f\u6301\u5927\u4f53\u79ef\u6d88\u606f\u5e76\u4e0d\u610f\u5473\u7740 Phoenix \u7528\u6237\u5728\u805a\u5408\u6839\u53ca\u4e1a\u52a1\u8bbe\u8ba1\u4e0a\u4e0d\u7528\u8003\u8651\u5185\u5b58\u5f00\u9500\u3002\u76f8\u53cd\uff0c\u4f7f\u7528\u4e86 Kafka Extend \u610f\u5473\u7740\u4e86\u653e\u5f00\u4e86\u6d88\u606f\u4f53\u79ef\u7684\u9650\u5236\uff0c\u90a3\u4e48\u66f4\u5e94\u8be5\u8c28\u614e\u8003\u8651\u80cc\u540e\u6240\u5e26\u6765\u7684\u5185\u5b58\u5f00\u9500\u3002"})]})}function k(e={}){const{wrapper:a}={...(0,i.a)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},51961:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-after-rebalanced-3ac5ead51f883f1d6cc820cf626e76aa.png"},48217:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-before-rebalanced-05dded0cde75ca94df9e82967f229c33.png"},19521:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-offset-track-04bfd28dc424b5785353159b5cdc7ee8.png"},49109:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-offset-42c16328d644cf51a9cc069d3867fb29.png"},68752:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-spring-error_01-bf9ec4a78cd2f165414fba2f80978cce.png"},39501:(e,a,n)=>{n.d(a,{Z:()=>r});const r=n.p+"assets/images/kafka-extend-spring-error_02-7b6ea4731a60dc36ecf1ca1e8bcdfbac.png"},11151:(e,a,n)=>{n.d(a,{Z:()=>c,a:()=>o});var r=n(67294);const i={},t=r.createContext(i);function o(e){const a=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(t.Provider,{value:a},e.children)}}}]);