<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-2.4.2 docs-doc-page docs-doc-id-phoenix-2.x/phoenix/why-event-driven-microservice" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">为什么需要事件驱动型微服务 | Phoenix</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="http://phoenix-website.sz.iquantex.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="http://phoenix-website.sz.iquantex.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="http://phoenix-website.sz.iquantex.com/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice"><meta data-rh="true" property="og:locale" content="zh_cn"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="2.4.2"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.4.2"><meta data-rh="true" name="docsearch:version" content="2.4.2"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.4.2"><meta data-rh="true" property="og:title" content="为什么需要事件驱动型微服务 | Phoenix"><meta data-rh="true" name="description" content="事件驱动型微服务就是在微服务架构中使用事件驱动思想。事件驱动系统的核心结构是事件的捕获、通信、处理和持久化，事件驱动架构的系统可以实现最小耦合，在现代分布式程序架构中尤为有用。"><meta data-rh="true" property="og:description" content="事件驱动型微服务就是在微服务架构中使用事件驱动思想。事件驱动系统的核心结构是事件的捕获、通信、处理和持久化，事件驱动架构的系统可以实现最小耦合，在现代分布式程序架构中尤为有用。"><link data-rh="true" rel="icon" href="/img/phoenix.png"><link data-rh="true" rel="canonical" href="http://phoenix-website.sz.iquantex.com/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice"><link data-rh="true" rel="alternate" href="http://phoenix-website.sz.iquantex.com/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="http://phoenix-website.sz.iquantex.com/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Phoenix RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Phoenix Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.565e9082.css">
<script src="/assets/js/runtime~main.ce1fc896.js" defer="defer"></script>
<script src="/assets/js/main.926a41ef.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Phoenix Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.png" alt="Phoenix Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">首页</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">文档</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduce">介绍</a></li><li><a class="dropdown__link" href="/docs/phoenix">快速入门</a></li><li><a class="dropdown__link" href="/docs/phoenix-core">Phoenix 框架</a></li><li><a class="dropdown__link" href="/docs/phoenix-transaction">Phoenix 事务</a></li><li><a class="dropdown__link" href="/docs/phoenix-observability">Phoenix 可观测性</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">博客</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-introduce">2.4.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduce">latest</a></li><li><a class="dropdown__link" href="/docs/2.6.0/introduce">2.6.0</a></li><li><a class="dropdown__link" href="/docs/2.5.5/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.5</a></li><li><a class="dropdown__link" href="/docs/2.5.4/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.4</a></li><li><a class="dropdown__link" href="/docs/2.5.3/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.3</a></li><li><a class="dropdown__link" href="/docs/2.5.2/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.2</a></li><li><a class="dropdown__link" href="/docs/2.5.1/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.1</a></li><li><a class="dropdown__link" href="/docs/2.5.0/phoenix-2.x/phoenix/why-event-driven-microservice">2.5.0</a></li><li><a class="dropdown__link" href="/docs/2.4.4/phoenix-2.x/phoenix/why-event-driven-microservice">2.4.4</a></li><li><a class="dropdown__link" href="/docs/2.4.3/phoenix-2.x/phoenix/why-event-driven-microservice">2.4.3</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice">2.4.2</a></li><li><a class="dropdown__link" href="/docs/2.4.1/phoenix-2.x/phoenix/phoenix-introduce">2.4.1</a></li><li><a class="dropdown__link" href="/docs/2.4.0/phoenix-2.x/phoenix/phoenix-introduce">2.4.0</a></li><li><a class="dropdown__link" href="/docs/2.2.4/phoenix-2.x/phoenix">2.2.4</a></li></ul></div><a href="https://github.com/PhoenixIQ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">整体介绍</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-introduce">Phoenix介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/why-event-driven-microservice">为什么需要事件驱动型微服务</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/how-event-driven-microservice">Phoenix实现事件驱动型微服务</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/quick-start-example/bookings-architecture">快速入门案例</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-all-future">功能总览</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-glossary">Phoenix概念</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-faq">FAQ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Phoenix Framework</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-core-client">客户端介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-core-entity-aggregate">实体聚合根</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-core-event-souring">事件溯源</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-core-event-store">事件管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-distributed-data">分布式数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-subscribe-pub">订阅与广播</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-cluster-manager">集群管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-core/phoenix-core-config">配置详情</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Phoenix Transaction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-transaction/phoenix-transaction-module">事务模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-transaction/phoenix-transaction-aggregate">使用说明</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Phoenix Event Publish</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-event-publish/event-publish-readme">功能介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-event-publish/event-publish-integration">使用说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-event-publish/event-publish-client-usage">订阅事件</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Phoenix DGC</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-dgc/phoenix-dgc-introduce">背景介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-dgc/phoenix-dgc-api">使用说明</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Phoenix 监控管理</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-console/phoenix-console-overall">服务架构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-console/phoenix-console-service-management">服务管理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-console/phoenix-console-business-monitor">业务监控</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-console/phoenix-console-system-monitor">系统监控</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">测试报告</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/features-test">功能性测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/performance-test">性能测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/available-test">可用性测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/elasticity-test">伸缩性测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/reliability-test">可靠性测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/pressure-test">压力测试</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/phoenix-2.x/phoenix-test/balance-test">均衡性测试</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>此为 <!-- -->Phoenix<!-- --> <b>2.4.2</b> 版的文档，现已不再积极维护。</div><div class="margin-top--md">最新的文档请参阅 <b><a href="/docs/introduce">最新版本</a></b> (<!-- -->latest<!-- -->)。</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">整体介绍</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">为什么需要事件驱动型微服务</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：2.4.2</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>为什么需要事件驱动型微服务</h1></header><blockquote>
<p>事件驱动型微服务就是在微服务架构中使用事件驱动思想。事件驱动系统的核心结构是事件的捕获、通信、处理和持久化，事件驱动架构的系统可以实现最小耦合，在现代分布式程序架构中尤为有用。</p>
<p>本文从如何在微服务架构中解耦微服务出发，介绍事件驱动型微服务。</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="微服务架构的特征和挑战">微服务架构的特征和挑战<a href="#微服务架构的特征和挑战" class="hash-link" aria-label="微服务架构的特征和挑战的直接链接" title="微服务架构的特征和挑战的直接链接">​</a></h2>
<p>在 2014 年 Martin Flower 和 James Lewis 合写的文章《<a href="https://martinfowler.com/articles/microservices.html" target="_blank" rel="noopener noreferrer">MicroServices</a>》定义了微服务架构风格。
在该文章中概括了&quot;微服务架构&quot;术语的含义：<strong>微服务架构风格是一种通过多个小型微服务组合来构建一个应用的架构风格，这些服务围绕业务能力而非特定的技术构建。每个服务可以采用不同的语言、数据存储技术在独立的进程中运行、自动化部署和运维。
服务间通过轻量级的机制通信。</strong> 并且列举了微服务架构应该具备的九大特征：</p>
<ul>
<li>以微服务而不是类库的方式实现程序组件化</li>
<li>围绕业务范围搭建团队</li>
<li>产品化思维</li>
<li>强终端弱管道</li>
<li>分散治理</li>
<li>数据去中心化</li>
<li>基础设施自动化</li>
<li>容错性设计</li>
<li>演进式设计</li>
</ul>
<p><img loading="lazy" alt="microservices-architecture" src="/assets/images/microservice-aa27638cd53a9d1ea50e61209ad63844.png" width="1108" height="747" class="img_ev3q"></p>
<p>微服务架构将应用系统以业务能力拆分为多个高度自治的微服务，降低耦合的同时也带来了一些分布式数据管理的挑战：</p>
<ol>
<li>如何识别每个微服务的边界？</li>
<li>如何从多个微服务中检索数据？</li>
<li>如何在多个微服务之间保持数据的一致性？</li>
<li>如何设计跨微服务边界的通信？</li>
</ol>
<p>单体应用架构的编程思维不适用于微服务架构上，若将原有的编程思维生搬硬套应用在微服务架构中会带来一些问题。如：在单体应用上不同组件之间通过引用进行方法调用。在微服务世界中，服务间通信必须设计一种通信机制，
传统编程思维设计的通信机制一般是 RPC 或者基于 HTTP 的 REST，它们的优点是简单、没有学习成本；缺点都是同步阻塞的请求，并且跨网络进行通信，因此当部分组件发生故障时会引发服务&quot;雪崩&quot;，所有依赖于此组件的服务全部不可用。</p>
<p>因此基于同步调用的服务间的微服务存在以下问题：</p>
<ol>
<li>代码层面存在耦合</li>
<li>同步调用的通信机制在分布式系统中不可靠</li>
</ol>
<p>那么为了解决该问题，可以在微服务架构中使用异步、松耦合的事件驱动架构。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="什么是事件驱动型微服务">什么是事件驱动型微服务<a href="#什么是事件驱动型微服务" class="hash-link" aria-label="什么是事件驱动型微服务的直接链接" title="什么是事件驱动型微服务的直接链接">​</a></h2>
<p>在<a href="https://en.wikipedia.org/wiki/Event-driven_architecture" target="_blank" rel="noopener noreferrer">维基百科</a>中是这样定义了事件驱动架构：<strong>事件驱动系统由事件生产者，事件消费者和事件通道组成，在松散耦合的组件或服务之间传输 事件.</strong></p>
<p>将事件驱动架构应用到微服务架构中时，服务间通信不再通过同步阻塞地网络调用，而是通过向事件通道发送事件和接受事件来完成。这意味着，发送事件的微服务无需知道接受事件的微服务是否存在，
也无需知道下游微服务如何进一步处理事件。因此，围绕事件驱动架构构建微服务系统能够带来一些好处：</p>
<ol>
<li>松耦合：事件生成方和使用方在逻辑上是分离，松耦合，意味着服务可以独立伸缩，更新和部署。</li>
<li>高性能：异步通信能够获得更快的响应，服务可以立即处理下一个请求，没有时间浪费在阻塞上，整体吞吐率提高。</li>
<li>可用性：松耦合的服务对故障更具弹性，当个别服务不可用时，其他服务不受影响，整体系统仍能对外提供服务，提高了系统的容错能力。</li>
<li>简化审计和事件溯源：基于事件的程序架构实现事件溯源模式十分简单。</li>
</ol>
<p><img loading="lazy" alt="even-driven-architecture" src="/assets/images/event-driven-53ce5ea3fe88c9420c18e59353809a59.png" width="1887" height="598" class="img_ev3q"></p>
<p>事件驱动的异步通信并非新概念，但十分契合微服务架构，因为异步通信能够极大地降低服务之间的耦合。 异步化通信系统实现时会有一些挑战：</p>
<ol>
<li>系统的设计思维会有所不同: 从面向状态的设计 -&gt; 面向行为(事件)的设计。</li>
<li>如果每个事件都需要被处理，那么如何保证事件的可靠交付？</li>
<li>如何保证处理和发布事件的原子性？</li>
</ol>
<p>EventSouring的设计模式很适合事件驱动，EventSouring推崇事件是一级公民。Phoenix提供了<a href="/docs/2.4.2/phoenix-2.x/phoenix/how-event-driven-microservice#phoenix%E4%B8%AD%E7%9A%84eventsourcing">EventSouring</a>的编程模式，并提供了可靠投递以及原子性处理和发布等功能。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="eventsouring介绍">EventSouring介绍<a href="#eventsouring介绍" class="hash-link" aria-label="EventSouring介绍的直接链接" title="EventSouring介绍的直接链接">​</a></h2>
<p>什么是 EventSouring？在 2005 年 Martin Flower 在企业应用架构模式的进一步发展系列文章中总结了 <a href="https://martinfowler.com/eaaDev/EventSourcing.html" target="_blank" rel="noopener noreferrer">EventSouring</a> 模式，文中描述了其概念：<strong>将应用程序状态的所有变更捕获为一系列事件</strong></p>
<p>EventSouring 的设计思想来源自基于关系型数据库存储数据所引发的一些问题。以两个案例举例：</p>
<p><strong>内存镜像</strong>：微服务架构中，服务高度自治，但来自客户端的请求通常都需要跨多个服务协同。基于数据库存储数据的应用程序不够高效，在微服务内对应用状态的修改需要 I/O 或远程调用；
EventSouring 将状态保存在应用程序内存中，实现了<a href="https://martinfowler.com/bliki/MemoryImage.html" target="_blank" rel="noopener noreferrer">内存镜像</a>，因此服务内的计算得到加速，使得应用整体性能得到提升。</p>
<p><strong>溯源能力</strong>：基于数据库存储的银行账户余额只是数据行中的一列数值，不具备历史记录功能，如需查看数据的历史状态必须通过数据库的审计日志或其他审计手段；EventSouring 以一系列不可变事实的事件来描述数据，以账户余额为例，其当前数值为一系列收入、支出事件的结果，
因此基于 EventSouring 持久化程序的状态时具备历史记录的能力，支持溯源和审计。</p>
<p>上述案例以不同角度展示了 EventSouring 的两大优势，除此之外 EventSouring 还具有一些其他优点：</p>
<ul>
<li>性能：因为事件是不可变的，因此在持久化事件时，可使用 append-only 操作，相比于关系型存储模型的 update，事件的存储更 简单。</li>
<li>简化：将复杂域对象存储到关系型存储中会带来<a href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_impedance_mismatch" target="_blank" rel="noopener noreferrer">阻抗失配</a>，而存储事件只需要简单保存。</li>
<li>审计：EventSouring 保存了系统状态的完整历史记录。</li>
<li>故障排除：基于生产环境中事件存储中的副本，可以在测试环境溯源事件以模拟故障的发生。</li>
<li>扩展性：EventSouring 中，事件是第一公民，因此十分契合发布/订阅系统，外部系统想要集成，只需要订阅事件即可。</li>
</ul>
<p>除此之外，基于 EventSouring 开发的应用程序，对数据库的依赖降低，因此可选择合适的事件持久化存储以提升弹性伸缩能力。例如 Phoenix 框架对内部的 EventStore 进行了优化，并借助于 Phoenix 集群的能力，提高了应用系统弹性伸缩的能力。</p>
<p><img loading="lazy" alt="eventsouring" src="/assets/images/eventsouring-7f9470b23bb13f49c34b186597047eb0.png" width="851" height="391" class="img_ev3q"></p>
<p>当然，在程序世界中没有一劳永逸的解决方案(没有银弹)。数据库也并非一无是处，大多数数据库对查询进行了大量优化，而 EventSouring 对数据的表达方式使得类似于&quot;所有金额大于200元的订单&quot;的查询实现困难，数据密集型应用极度依赖查询能力。因此，基于 EventSouring 开发的应用程序面临着如下挑战：</p>
<ul>
<li>性能：当事件增长后，从事件存储中查询，并通过溯源事件加载对象状态的效率会越来越低。</li>
<li>版本控制：当业务发展或者需求变更后，事件的类型或者聚合的定义发生了改变，需要考虑应用程序应该如何处理多个版本的事件类型和聚合。</li>
<li>复杂查询难以优化</li>
</ul>
<p>对于查询问题，通用的解决方案是将 EventSouring 与 CQRS 结合使用，互相增加利益。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cqrs介绍">CQRS介绍<a href="#cqrs介绍" class="hash-link" aria-label="CQRS介绍的直接链接" title="CQRS介绍的直接链接">​</a></h2>
<p>CQRS 是一种架构模式，CQRS 将系统的操作分为两类：<code>命令</code>和<code>查询</code>，其核心思想是将两类不同的操作进行分离，在两个独立的服务中实现。这种分离的好处是通过直接
应用单一职责原则来阐明和简化代码，并且能够独立扩展每个服务。不同于 CQS，CQRS 应用的不是代码级别，而是应用程序级别的分离。</p>
<p><img loading="lazy" alt="cqrs" src="/assets/images/cqrs-pattern-b30300eeb7ae312be6953dade4cc165a.png" width="957" height="675" class="img_ev3q"></p>
<p>对于 EventSouring 来说，CQRS 的出现就像是在夜空中目睹了一颗百年一遇的美丽流星。将 CQRS 与 EventSouring 结合使用弥补了 EventSouring 查询的缺陷，仿佛是为 EventSouring 而生。在两者共生的架构中 EventSouring 用作纯粹的写入模型，并将数据状态投影到读模型，此时开发者可以选择最合适的技术来优化读取模型来实现复杂查询。</p>
<p>不仅如此，CQRS 也能够解决微服务架构中跨服务查询难题：在微服务架构中单独为查询建立读模型并优化以解决跨服务查询的难题(如下图所示)：</p>
<p><img loading="lazy" alt="cqrs-microservice" src="/assets/images/cqrs-microservice-915ce24428296f992d95554f6b4ee9ae.png" width="971" height="461" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2>
<p>本文从微服务架构的解耦出发，一步步引入事件驱动架构、EventSouring 和 CQRS，到文末已经足够建立一个成熟的松耦合、可伸缩、高可用、高性能的微服务架构，但此时也引入了复杂性，并且在实际的生产环境中还需要考虑到一些边界条件，以及上述并未解决的一些问题，如：事件的版本控制。</p>
<p>基于此，宽拓自主研发了基于 EventSouring 和 CQRS 实现的事件驱动型微服务框架 <a href="https://phoenix.iquantex.com/" target="_blank" rel="noopener noreferrer"><strong>Phoenix</strong></a>帮助开发者落地高性能的事件驱动型微服务架构，Phoenix 的可用性在金融场景的生产环境中得到了验证，后续的文章将从 Phoenix 实现微服务出发，介绍 Phoenix 的能力以及面对问题时 Phoenix 的解决方案。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="引用">引用<a href="#引用" class="hash-link" aria-label="引用的直接链接" title="引用的直接链接">​</a></h2>
<p>博客和文章：</p>
<ul>
<li><a href="https://martinfowler.com/articles/microservices.html" target="_blank" rel="noopener noreferrer">微服务</a>. Martin Fowler</li>
<li><a href="https://martinfowler.com/articles/201701-event-driven.html" target="_blank" rel="noopener noreferrer">事件驱动的含义</a>. Martin Fowler</li>
<li><a href="https://martinfowler.com/eaaDev/EventSourcing.html" target="_blank" rel="noopener noreferrer">事件溯源</a>. Martin Fowler</li>
<li><a href="https://martinfowler.com/bliki/CQRS.html" target="_blank" rel="noopener noreferrer">CQRS</a>. Martin Fowler</li>
<li><a href="https://docs.microsoft.com/et-ee/dotnet/architecture/microservices/architect-microservice-container-applications/asynchronous-message-based-communication" target="_blank" rel="noopener noreferrer">基于消息的异步通信</a>. Microsoft</li>
</ul>
<p>会议演讲：</p>
<ul>
<li><a href="https://www.youtube.com/watch%EF%BC%9Fv=STKCRSUsyP0" target="_blank" rel="noopener noreferrer">事件驱动架构的多种含义</a>. Martin Fowler</li>
<li><a href="https://www.youtube.com/watch%EF%BC%9Fv=ksRCq0BJef8" target="_blank" rel="noopener noreferrer">创建事件驱动架构的微服务</a>. Andrew Schofield</li>
<li><a href="https://www.youtube.com/watch%EF%BC%9Fv=kyNL7yCvQQc" target="_blank" rel="noopener noreferrer">不只是事件：开发异步化微服务</a>. Chris Richardson</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/PhoenixIQ/versioned_docs/version-2.4.2/phoenix-2.x/01-phoenix/02-why-event-driven-microservice.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/2.4.2/phoenix-2.x/phoenix/phoenix-introduce"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Phoenix介绍</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/2.4.2/phoenix-2.x/phoenix/how-event-driven-microservice"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Phoenix实现事件驱动型微服务</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#微服务架构的特征和挑战" class="table-of-contents__link toc-highlight">微服务架构的特征和挑战</a></li><li><a href="#什么是事件驱动型微服务" class="table-of-contents__link toc-highlight">什么是事件驱动型微服务</a></li><li><a href="#eventsouring介绍" class="table-of-contents__link toc-highlight">EventSouring介绍</a></li><li><a href="#cqrs介绍" class="table-of-contents__link toc-highlight">CQRS介绍</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li><li><a href="#引用" class="table-of-contents__link toc-highlight">引用</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduce">Phoenix介绍</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/phoenix/quick-start-example/bookings-architecture">快速入门</a></li></ul></div><div class="col footer__col"><div class="footer__title">案例</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/PhoenixIQ/phoenix-samples/tree/master/bank-account" target="_blank" rel="noopener noreferrer" class="footer__link-item">账户管理<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/PhoenixIQ/phoenix-sample-risk" target="_blank" rel="noopener noreferrer" class="footer__link-item">交易风控<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/PhoenixIQ/phoenix-samples/tree/master/shopping-cart" target="_blank" rel="noopener noreferrer" class="footer__link-item">购物车<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/PhoenixIQ/hotel-booking" target="_blank" rel="noopener noreferrer" class="footer__link-item">酒店预订<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">资源</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">博客</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">北京宽拓智融科技有限公司 Copyright @2013 - 2023 iQuantex.com All Rights Reserved. 宽拓公司 版权所有</div></div></div></footer></div>
</body>
</html>