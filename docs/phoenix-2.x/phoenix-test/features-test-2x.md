---
id: features-test-2x
title: 功能性测试
---

 ## 前言

 Phoenix是宽拓自主研发的一款事件驱动型的高性能Java开发框架，专注于降低金融行业中业务复杂性高、性能要求高的应用系统的开发难度，助力研发团队打造专业、高效的微服务化的金融应用系统。

 本篇测试报告主要验证了 Phoenix 提供的如下功能：

  - 基于 Phoenix-lite 账户划拨转账功能正常
  - grafana 使用正常
  - EventSourcing 使用正常
  - Snapshot 使用正常

## Phoenix-lite 转账功能

### 概述

验证 phoenix-lite 账户转账功能。

### 原理介绍

phoenix-lite 提供了随机转账和定向转账两个功能：

 1. 定向转账：账户A向账户B转入指定的金额（每个账户默认初始有1000元）
 2. 随机转账： 指定账户范围和转账次数，多个账户之间进行随机转账。

### 测试方案

#### 场景描述

分别使用 Phoenix-lite 提供的两个转账接口进行下单测试。

#### 校验方法

 - 定向转账：校验账户A和账户B的余额
 - 随机转账：转入次数+转出次数 = 2*转账次数

### 测试步骤


## Grafana 功能

### 概述

Phoenix 提供了一套默认的 Grafana 监控面板，用于监控 Phoenix 应用的运行情况。监控指标包括如下内容：

 - 消息个数统计
 - 指标个数统计
 - 耗时统计
 - 速率统计
 - 数据总览

### 原理介绍

可以直观的监控到 Phoenix 应用每次下单之后的运行情况。

### 测试方案

#### 场景描述

使用 Phoenix-lite 提供的随机转账功能进行下单测试，然后在grafana面板上观看监测数据。

#### 校验方法

使用 Phoenix-lite 进行 1000 笔随机转账测试，然后在 grafana 面板上验证转账次数是否符合预期   ******** TODO  ******** 

关于 Grafana 各个监控指标的说明请参考：。。。

### 测试步骤


## EventSourcing 功能

### 概述

Phoenix保证其内存数据正确性的核心原理在于EventSourcing(事件溯源技术)。

### 原理介绍

Phoenix是EDA架构的框架，可以基于事件重塑内存，Phoenix会对所有处理过的事件进行持久化，在节点重启或者聚合根漂移时通过EventSourcing重塑内存状态。

### 测试方案

#### 场景描述

使用 Phoenix-lite 提供的随机转账功能，首先构造固定数量的请求，处理完成之后观察内存数据情况，然后重启节点并进行定向转账并查看内存数据是否符合预期。

#### 校验方法

在 Phoenix-lite 页面通过内存查询功能，观察最终的结果是否正确。

### 测试步骤


## Snapshot 功能

### 概述

Phoenix 应用可以通过EventSourcing功能进行内存数据恢复，使用Snapshot可以加快EventSourcing的内存恢复的速度。

### 原理介绍

Snapshot是对某一瞬间Phoenix应用内存的一次存储。Phoenix提供了两种大快照的方式。

 1. 每处理1000笔消息自动打一次快照
 2. 手动触发打快照

### 测试方案

#### 场景描述

使用 Phoenix-lite 提供的随机转账功能，首先构造 1000 笔下单请求，处理完成之后观察是否打快照，然后重启节点观察EventSourcing过程中是否使用快照。

#### 校验方法



### 测试步骤

